{"version":3,"file":"validator.js","sources":["../src/utils.js","../src/rules.js","../src/validator.js","../src/analyzer.js","../src/index.js"],"sourcesContent":["export const isArray = (val) => {\r\n  return Object.prototype.toString.call(val) === '[object Array]'\r\n}\r\n\r\n/**\r\n* 判断一值是否存在数组里\r\n***/\r\nexport const inArray = (val, arr) => {\r\n  for (let k in arr) {\r\n    if (arr[k] === val) return true\r\n  }\r\n  return false\r\n}\r\n","import {isArray, inArray} from './utils'\r\n\r\nexport default {\r\n  // 规则名 (待验证值, 规则值) {return Boolean}\r\n  required (val, rval) {\r\n    if (rval) {\r\n      return val !== undefined\r\n    }\r\n    return true\r\n  },\r\n  eq (val, rval) {\r\n    return val === rval\r\n  },\r\n  not (val, rval) {\r\n    return val !== rval\r\n  },\r\n  type (val, rval) {\r\n    if (val === null || val === undefined) {\r\n      return val === rval\r\n    }\r\n    // String,Object,Array,Number,Boolean,Date,...包括自定义对象  (除null,undefined)\r\n    return val.constructor === rval\r\n  },\r\n  length (val, rval) {\r\n    if (!isArray(rval)) {\r\n      return !!(val && val.length && (val.length === rval))\r\n    }\r\n    if (typeof val === 'string' || isArray(val)) {\r\n      return val.length >= rval[0] && val.length <= rval[1]\r\n    }\r\n  },\r\n  min (val, rval) {\r\n    return val >= rval\r\n  },\r\n  max (val, rval) {\r\n    return val <= rval\r\n  },\r\n  gt (val, rval) {\r\n    return val > rval\r\n  },\r\n  gte (val, rval) {\r\n    return val >= rval\r\n  },\r\n  lt (val, rval) {\r\n    return val < rval\r\n  },\r\n  lte (val, rval) {\r\n    return val <= rval\r\n  },\r\n  between (val, rval) {\r\n    return rval[0] <= val && val <= rval[1]\r\n  },\r\n  notBetween (val, rval) {\r\n    return val < rval[0] || val > rval[1]\r\n  },\r\n  in (targetVal, ruleVal) {\r\n    if (isArray(ruleVal)) {\r\n      return inArray(targetVal, ruleVal)\r\n    }\r\n    if (typeof ruleVal === 'object') {\r\n      return targetVal in ruleVal\r\n    }\r\n    if (typeof ruleVal === 'string') {\r\n      return ruleVal.indexOf(targetVal) > -1\r\n    }\r\n    return false\r\n  },\r\n  notIn (val, rval) {\r\n    if (isArray(rval)) {\r\n      return !inArray(val, rval)\r\n    }\r\n    if (typeof rval === 'object') {\r\n      return !(val in rval)\r\n    }\r\n    if (typeof rval === 'string') {\r\n      return (rval.indexOf(val) === -1)\r\n    }\r\n    return false\r\n  },\r\n  match (val, regexp) {\r\n    if (typeof val !== 'string') return false\r\n    var reg = new RegExp(regexp)\r\n    return reg.test(val)\r\n  },\r\n  notMatch (val, regexp) {\r\n    if (typeof val !== 'string') return false\r\n    var reg = new RegExp(regexp)\r\n    return !reg.test(val)\r\n  },\r\n  like (val, rval) {\r\n    // like \r\n    //   %abc     /abc$/\r\n    //   abc%     /^abc/\r\n    //   a%bc     /^a.*bc$/\r\n    //   %a%bc    /a.*cb$/\r\n    //   a%bc%    /^a.*bc/\r\n    //   %a%bc%   /a.*bc/\r\n    if (typeof rval !== 'string') return false\r\n    if (rval[0] !== '%') {\r\n      rval = '^' + rval\r\n    }\r\n    if (rval[rval.length - 1] !== '%') {\r\n      rval = rval + '$'\r\n    }\r\n    var regexp = new RegExp(rval.replace(/%/g, '.*'))\r\n    return regexp.test(val)\r\n  },\r\n  notLike (val, rval) {\r\n    if (typeof rval !== 'string') return false\r\n    if (rval[0] !== '%') {\r\n      rval = '^' + rval\r\n    }\r\n    if (rval[rval.length - 1] !== '%') {\r\n      rval = rval + '$'\r\n    }\r\n    var regexp = new RegExp(rval.replace(/%/g, '.*'))\r\n    return !regexp.test(val)\r\n  },\r\n  email (val, rval) {\r\n    var regexp = /^[A-Za-z0-9\\u4e00-\\u9fa5]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$/\r\n    if (rval) {\r\n      return regexp.test(val)\r\n    }\r\n    return true\r\n  },\r\n  upperCase (val, rval) {\r\n    if (rval) {\r\n      return val === val.toUpperCase()\r\n    }\r\n    return true\r\n  },\r\n  lowerCase (val, rval) {\r\n    if (rval) {\r\n      return val === val.toLowerCase()\r\n    }\r\n    return true\r\n  },\r\n  run (val, rval) {\r\n    if (typeof rval === 'function') {\r\n      return rval(val)\r\n    }\r\n    return true\r\n  }\r\n}\r\n","import {isArray} from './utils'\r\nimport Rule from './rules'\r\n\r\nfunction Validator (data, constraints) {\r\n  if (!this instanceof Validator){\r\n    throw new Error('Validator is a constructor and should be called with the `new` keyword')\r\n  }\r\n  this.data = data\r\n  this.constraints = constraints\r\n  this.results = null\r\n  this.count = 0\r\n}\r\n\r\nValidator.prototype.validate = function (isOne) {\r\n  var result = {}\r\n  for (let field in this.constraints) {\r\n    let constraint = this.constraints[field]\r\n    result[field] = {}\r\n    var count = 0\r\n    for (let type in constraint) {\r\n      var rule = constraint[type]\r\n      var bool = this.validRule(type, this.data[field], rule)\r\n      count += ~~!bool\r\n      result[field][type] = {val: rule.val, msg: rule.msg, result: bool}\r\n    }\r\n    // console.log(field, count, constraint.required)\r\n    if (count > 0) {\r\n      if (constraint.required && constraint.required.val) {\r\n        this.count++\r\n        if (isOne)\r\n          break\r\n      }\r\n      if (this.data[field] !== undefined) {\r\n        this.count++\r\n        if (isOne)\r\n          break\r\n      }\r\n    }\r\n  }\r\n  this.results = result\r\n  // console.log('验证结果：', result)\r\n  return result\r\n}\r\n\r\nValidator.prototype.validRule = function (type, val, rule) {\r\n  var ruleFun = Rule[type]\r\n  if (!ruleFun) {\r\n    throw new Error('undefined rule type: `'+ type +'`')\r\n  }\r\n  return ruleFun.apply(this.constraints || null, [val, rule.val])\r\n}\r\n\r\nexport default Validator\r\n","// 验证分析\r\nfunction Analyzer (validator) {\r\n\r\n  // console.log(validator)\r\n  var that = this\r\n  this.valider = function () {\r\n    return validator\r\n  }\r\n  this.errors = null\r\n  this.msgs = []\r\n  // 代理\r\n  // return new Proxy(validator.results, {\r\n  //   get (target, key) {\r\n  //     // 优先访问results\r\n  //     if (target[key]) {\r\n  //       return target[key]\r\n  //     } else {\r\n  //       return that[key]\r\n  //     }\r\n  //   }\r\n  // })\r\n}\r\nAnalyzer.prototype.parseMsg = function (msg) {\r\n  return msg\r\n}\r\nAnalyzer.prototype.fails = function () {\r\n  return this.valider().count > 0\r\n}\r\nAnalyzer.prototype.all = function (isArr) {\r\n  if (!this.errors) {\r\n    this.errors = {}\r\n    for (let field in this.valider().results) {\r\n      this.errors[field] = this.get(field)\r\n    }\r\n  }\r\n  if (isArr) {\r\n    var err = []\r\n    for (let field in this.errors) {\r\n      if (this.errors[field].length > 0) {\r\n        for (var i in this.errors[field]) {\r\n          err.push(this.errors[field][i])\r\n        }\r\n      }\r\n    }\r\n    return err\r\n  } else {\r\n    return this.errors\r\n  }\r\n}\r\n\r\nAnalyzer.prototype.get = function (field, isOrign) {\r\n  var result = this.valider().results[field]\r\n  if (!result) {\r\n    console.warn('The field does not exist in constraints')\r\n    return []\r\n  }\r\n  if (isOrign) {\r\n    return result\r\n  }\r\n  // 当需要验证数据不存在此字段并且不必须的字段时，返回[]\r\n  if (this.valider().data[field] === undefined) {\r\n    // 不提供required验证情况\r\n    if (!result.hasOwnProperty('required')) {\r\n      return []\r\n    }\r\n    // 存在required验证情况\r\n    if (result.hasOwnProperty('required') && result.required.result) {\r\n      return []\r\n    }\r\n  }\r\n  var msg = []\r\n  for (let type in result) {\r\n    if (!result[type].result) {\r\n      msg.push(this.parseMsg(result[type].msg))\r\n    }\r\n  }\r\n  return msg\r\n}\r\nAnalyzer.prototype.has = function (field) {\r\n  return this.get(field).length > 0\r\n}\r\nAnalyzer.prototype.first = function (field) {\r\n  if (field) {\r\n    return this.get(field)[0]\r\n  }\r\n  if (!this.errors) {\r\n    this.all()\r\n  }\r\n  for (let field in this.errors) {\r\n    if (this.errors[field].length > 0) {\r\n      return this.errors[field][0]\r\n    }\r\n  }\r\n}\r\nAnalyzer.prototype.last = function (field) {\r\n  var msgs = this.get(field)\r\n  return msgs[msgs.length - 1]\r\n}\r\n\r\nexport default Analyzer\r\n","import {isArray} from './utils'\r\nimport Validator from './validator'\r\nimport Analyzer from './analyzer'\r\nimport Rules from './rules'\r\nfunction formatConstraint (constraints) {\r\n  var constraint = {}\r\n  for (var i in constraints)\r\n  for (var type in constraints[i]) {\r\n    var cr = constraints[i]\r\n    if (type !== 'msg') {\r\n      constraint[type] = {val: cr[type], msg: cr.msg}\r\n    }\r\n  }\r\n  return constraint\r\n}\r\n\r\nvar valid = {\r\n  Validator,\r\n  Rule: Rules,\r\n  validate: function (data, constraints, isOne) {\r\n    var vdata = {}\r\n    for (var key in constraints) {\r\n      vdata[key] = {}\r\n      if (isArray(constraints[key])) {\r\n        vdata[key] = formatConstraint(constraints[key])\r\n      } else if (typeof constraints[key] === 'object') {\r\n        vdata[key] = formatConstraint([constraints[key]])\r\n      }\r\n    }\r\n    // console.log('格式化后：', vdata)\r\n    let valider = new Validator(data, vdata)\r\n    valider.validate(isOne)\r\n    return new Analyzer(valider)\r\n  },\r\n  pushRule: function (type, fun) {\r\n    if (Rules.hasOwnProperty(type)) {\r\n      console.warn('The rule type `' + type + '` is exist')\r\n      return false\r\n    }\r\n    if (typeof fun !== 'function') {\r\n      console.warn('The rule fun must be a function')\r\n      return false\r\n    }\r\n    Rules[type] = fun\r\n    console.log(Rules)\r\n    return true\r\n  }\r\n}\r\nexport default valid\r\n"],"names":["isArray","val","Object","prototype","toString","call","inArray","arr","k","rval","undefined","constructor","length","targetVal","ruleVal","indexOf","regexp","reg","RegExp","test","replace","toUpperCase","toLowerCase","Validator","data","constraints","Error","results","count","validate","isOne","result","field","constraint","type","rule","bool","validRule","msg","required","ruleFun","Rule","apply","Analyzer","validator","valider","errors","msgs","parseMsg","fails","all","isArr","get","err","i","push","isOrign","warn","hasOwnProperty","has","first","last","formatConstraint","cr","valid","Rules","vdata","key","babelHelpers.typeof","fun","log"],"mappings":"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"}